version: '1.0'
steps:

    build-step:
        description: Building the image.
        type: build
        dockerfile: Dockerfile
        image-name: advance512demo/demochat
        tag: codefresh
    stuck-composition-step:
      description: A composition step that will get "stuck".
      type: composition
      composition: 
        version: '2'
        services:
          app:
            image: 'advance512demo/demochat:master'
            ports:
              - 5000
            depends_on:
              - mongo
          mongo:
            image: mongo
      composition-candidates:
        main:
          image: nhoag/curl
          command: bash -c "sleep 2000 && curl http://app:5000/" | echo 'works'
    push-step:
        description: Pushing image to Docker hub.
        type: push
        candidate: ${{build-step}}
        tag: ${{CF_BRANCH}}        



